<script>
  function encodeTarget(url) {
    return encodeURIComponent(url);
  }

  function launch() {
    const input = document.getElementById('urlInput').value.trim();
    
    // Validate URL format
    try {
      new URL(input);
    } catch {
      alert("Invalid URL format. Please include http:// or https://");
      return;
    }

    // Prepend the best proxy: corsproxy.io
    const proxyUrl = `https://corsproxy.io/?url=${encodeTarget(input)}`;

    const newTab = window.open("", "_blank");
    if (!newTab || newTab.closed === undefined) {
      alert("Pop-up blocked! Please allow pop-ups for this site.");
      return;
    }

    newTab.document.write(`
      <html>
        <body style="margin:0;padding:0;">
          <iframe src="${proxyUrl}" style="width:100vw;height:100vh;border:none;"></iframe>
        </body>
      </html>
    `);
    newTab.document.close();
  }
</script>
